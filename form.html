<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>P2P</title>
  <style>
    body{font-family:sans-serif;background:#f7f7f7;padding:20px}
    .card{background:#fff;max-width:700px;margin:auto;padding:20px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
    h1{margin-top:0;text-align:center;color:#2563eb}
    label{display:block;margin-top:15px;font-weight:600;color:#374151}
    input,select,textarea{width:100%;padding:10px;margin-top:6px;border:1px solid #ccc;border-radius:8px;font-size:14px}
    textarea{resize:vertical;min-height:80px}
    button{margin-top:20px;padding:12px 18px;border:none;border-radius:8px;cursor:pointer;font-weight:bold;margin-right:10px}
    .submit{background:#2563eb;color:#fff}
    .submit:hover{background:#1d4ed8}
    .submit:disabled{background:#9ca3af;cursor:not-allowed}
    .reset{background:#f3f4f6;color:#374151}
    .reset:hover{background:#e5e7eb}
    .loading{display:none;color:#2563eb;margin-top:10px}
    .success{display:none;color:#059669;background:#d1fae5;padding:10px;border-radius:8px;margin-top:10px}
    .error{display:none;color:#dc2626;background:#fee2e2;padding:10px;border-radius:8px;margin-top:10px}
    .required{color:#dc2626}
  </style>
</head>
<body>
  <div class="card">
    <h1>üìù ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h1>
    <p style="text-align:center;color:#6b7280;margin-bottom:20px">
      ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤
    </p>
    
    <form id="surveyForm">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
        <input type="text" name="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" />
      </label>

      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        <input type="date" name="date" />
      </label>

      <label>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô <span class="required">*</span>
        <select name="service" required>
          <option value="" disabled selected>‚Äî ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äî</option>
          <option>‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå/‡πÅ‡∏≠‡∏õ</option>
          <option>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
        </select>
      </label>

      <label>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å/‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
        <select name="channel">
          <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‚Äî</option>
          <option>‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</option>
          <option>‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢</option>
          <option>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô</option>
          <option>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
        </select>
      </label>

      <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à <span class="required">*</span>
        <small style="color:#6b7280">(1 = ‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î, 5 = ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î)</small>
      </label>
      <select name="total_score" required>
        <option value="">‚Äî ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äî</option>
        <option value="1">1 - ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à‡∏°‡∏≤‡∏Å</option>
        <option value="2">2 - ‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à</option>
        <option value="3">3 - ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
        <option value="4">4 - ‡∏û‡∏≠‡πÉ‡∏à</option>
        <option value="5">5 - ‡∏û‡∏≠‡πÉ‡∏à‡∏°‡∏≤‡∏Å</option>
      </select>

      <label>üí¨ ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ - ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö
        <textarea name="like" placeholder="‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏≠‡∏ö‡πÉ‡∏à..."></textarea>
      </label>

      <label>üîß ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ - ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á
        <textarea name="improve" placeholder="‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤..."></textarea>
      </label>

      <label>üí° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ
        <textarea name="other" placeholder="‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡πÜ..."></textarea>
      </label>

      <div>
        <button type="submit" class="submit" id="submitBtn">
          üì§ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
        </button>
        <button type="reset" class="reset">
          üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
        <a class="btn btn-ghost" href="index.html">HOME</a>
      </div>
      
      <div class="loading" id="loading">
        ‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
      </div>
      
      <div class="success" id="success">
        ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô
      </div>
      
      <div class="error" id="error">
        ‚ùå <span id="errorMessage">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</span>
      </div>
    </form>
  </div>

<script>
  // ‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  document.querySelector('input[name="date"]').value = new Date().toISOString().split('T')[0];
  
  document.getElementById("surveyForm").addEventListener("submit", function(e){
    e.preventDefault();
    
    // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πà‡∏≤
    document.getElementById('success').style.display = 'none';
    document.getElementById('error').style.display = 'none';
    
    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
    document.getElementById('loading').style.display = 'block';
    document.getElementById('submitBtn').disabled = true;
    document.getElementById('submitBtn').textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';
    
    const formData = new FormData(this);

    // üîó ‡πÉ‡∏™‡πà Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const webAppUrl = "https://script.google.com/macros/s/AKfycbzRKmFF030MwE9gfrJSYqLC96p8OAIQ9HRbkGWZmzTrO19LvV2T3BXwmQafjRPY1DIT/exec";
    
    fetch(webAppUrl, {
      method: "POST",
      body: formData   // ‚úÖ ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô FormData ‡∏ï‡∏£‡∏á ‡πÜ
    })
    .then(() => {
      // ‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô response ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô CORS block)
      document.getElementById('loading').style.display = 'none';
      document.getElementById('submitBtn').disabled = false;
      document.getElementById('submitBtn').textContent = 'üì§ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';
      document.getElementById('success').style.display = 'block';
      this.reset();
      document.querySelector('input[name="date"]').value = new Date().toISOString().split('T')[0];
      document.getElementById('success').scrollIntoView({ behavior: 'smooth' });
    })
    .catch(error => {
      console.error('Error:', error);
      document.getElementById('loading').style.display = 'none';
      document.getElementById('submitBtn').disabled = false;
      document.getElementById('submitBtn').textContent = 'üì§ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';
      document.getElementById('errorMessage').textContent = 
        '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message + ' ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
      document.getElementById('error').style.display = 'block';
      document.getElementById('error').scrollIntoView({ behavior: 'smooth' });
    });
  });
  
  // Reset form
  document.querySelector('button[type="reset"]').addEventListener('click', function() {
    document.getElementById('success').style.display = 'none';
    document.getElementById('error').style.display = 'none';
    document.getElementById('loading').style.display = 'none';
    setTimeout(() => {
      document.querySelector('input[name="date"]').value = new Date().toISOString().split('T')[0];
    }, 100);
  });
</script>

</body>
</html>
