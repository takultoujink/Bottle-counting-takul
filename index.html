<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>P2P</title>
  <meta name="description" content="เปลี่ยนขวดพลาสติกเป็นแต้มสะสม ง่ายๆ แค่โยนขวด รับแต้มทันที เพื่อโลกที่ยั่งยืน" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
  <style>
    :root{
      --bg: #fdfbff;          /* พื้นหลังขาวนวล */
      --bg-secondary: #f8f4ff; /* พื้นหลังรอง */
      --card: #ffffff;        /* การ์ดขาว */
      --text: #2d1b4e;        /* ข้อความหลัก เข้ม */
      --muted: #6b5b73;       /* ข้อความรอง */
      --brand: #a78bfa;       /* ม่วงพาสเทล */
      --brand-2: #67e8f9;     /* ฟ้าพาสเทล */
      --accent: #fb7185;      /* ชมพูพาสเทล */
      --accent-2: #4ade80;    /* เขียวพาสเทล */
      --accent-3: #fbbf24;    /* เหลืองพาสเทล */
      --radius-xl: 24px;
      --radius: 16px;
      --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-soft: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    /* รีเซ็ตเล็กน้อย */
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans Thai", "Noto Sans", "Liberation Sans", sans-serif;
      color:var(--text); 
      background: 
        linear-gradient(135deg, var(--bg) 0%, var(--bg-secondary) 100%);
      background-attachment: fixed;
      line-height:1.6; letter-spacing:.2px;
      min-height: 100vh;
    }
    
    /* Pastel floating shapes */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, var(--brand) 0%, transparent 30%),
        radial-gradient(circle at 80% 20%, var(--brand-2) 0%, transparent 25%),
        radial-gradient(circle at 40% 70%, var(--accent) 0%, transparent 20%),
        radial-gradient(circle at 70% 80%, var(--accent-2) 0%, transparent 25%),
        radial-gradient(circle at 90% 60%, var(--accent-3) 0%, transparent 15%);
      background-size: 800px 800px, 600px 600px, 700px 700px, 500px 500px, 400px 400px;
      opacity: 0.1;
      animation: floatPastel 60s ease-in-out infinite;
      z-index: -1;
      pointer-events: none;
    }
    
    /* Smooth pastel animation */
    @keyframes floatPastel {
      0%, 100% {
        transform: translate(0, 0) rotate(0deg);
      }
      25% {
        transform: translate(-20px, -30px) rotate(90deg);
      }
      50% {
        transform: translate(15px, -20px) rotate(180deg);
      }
      75% {
        transform: translate(-10px, 25px) rotate(270deg);
      }
    }

    .container{ width:min(1100px, 92%); margin-inline:auto; }

    :root{
      --bg: #fdfbff;          /* พื้นหลังขาวนวล */
      --bg-secondary: #f8f4ff; /* พื้นหลังรอง */
      --card: #ffffff;        /* การ์ดขาว */
      --text: #2d1b4e;        /* ข้อความหลัก เข้ม */
      --muted: #6b5b73;       /* ข้อความรอง */
      --brand: #a78bfa;       /* ม่วงพาสเทล */
      --brand-2: #67e8f9;     /* ฟ้าพาสเทล */
      --accent: #fb7185;      /* ชมพูพาสเทล */
      --accent-2: #4ade80;    /* เขียวพาสเทล */
      --accent-3: #fbbf24;    /* เหลืองพาสเทล */
      --radius-xl: 24px;
      --radius: 16px;
      --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-soft: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    /* Dark mode variables */
    [data-theme="dark"] {
      --bg: #0f0f23;          /* พื้นหลังดำนวล */
      --bg-secondary: #1a1a2e; /* พื้นหลังรองดำ */
      --card: #16213e;        /* การ์ดดำ */
      --text: #e2e8f0;        /* ข้อความหลัก ขาว */
      --muted: #94a3b8;       /* ข้อความรอง */
      --brand: #a78bfa;       /* ม่วงพาสเทล */
      --brand-2: #67e8f9;     /* ฟ้าพาสเทล */
      --accent: #fb7185;      /* ชมพูพาสเทล */
      --accent-2: #4ade80;    /* เขียวพาสเทล */
      --accent-3: #fbbf24;    /* เหลืองพาสเทล */
      --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
      --shadow-soft: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
    }
    /* Navbar */
    .nav{ position:sticky; top:0; z-index:50; backdrop-filter:saturate(180%) blur(20px); background:rgba(253, 251, 255, 0.8); border-bottom:1px solid rgba(167, 139, 250, 0.2); }
    .nav-inner{ display:flex; align-items:center; justify-content:space-between; padding:16px 0; }
    .brand{ display:flex; align-items:center; gap:12px; text-decoration:none; color:var(--text); font-weight:800; font-size:18px; }
    .logo{ width:42px; height:42px; border-radius:12px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); box-shadow: var(--shadow-soft); }
    .logo-img{ width:56px; height:56px; border-radius:14px; object-fit:cover; box-shadow: var(--shadow); border: 2px solid rgba(167, 139, 250, 0.2); transition: all .3s ease; }
    .logo-img:hover{ transform: scale(1.05); box-shadow: 0 20px 40px -12px rgba(167, 139, 250, 0.3); }
    .nav-links{ display:flex; gap:8px; }
    .nav-links a{ color:var(--muted); text-decoration:none; font-weight:600; padding:10px 16px; border-radius:12px; transition: all .3s ease; }
    .nav-links a:hover{ color:var(--text); background:linear-gradient(135deg, var(--brand), var(--brand-2)); background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent; transform:translateY(-2px); }

    /* Hero */
    .hero{ padding:100px 0 60px; }
    .hero-grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap:40px; align-items:center; }
    .eyebrow{ display:inline-flex; align-items:center; gap:12px; padding:8px 16px; border:2px solid var(--brand); border-radius:999px; color:var(--brand); background: linear-gradient(135deg, var(--brand), var(--brand-2)); background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent; font-weight:700; transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .eyebrow:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(167, 139, 250, 0.2); }
    .pulse-dot{ width:10px; height:10px; border-radius:50%; background: var(--accent-2); box-shadow:0 0 0 8px rgba(74, 222, 128, 0.2); animation:pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { transform:scale(1); opacity:1; } 50% { transform:scale(1.2); opacity:0.7; } }
    h1{ font-size: clamp(40px, 6vw, 72px); line-height:1.1; margin:20px 0 18px; background:linear-gradient(135deg, var(--text), var(--brand)); background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent; font-weight:900; text-shadow: 0 5px 15px rgba(167, 139, 250, 0.2); }
    .lead{ font-size: clamp(18px, 2vw, 22px); color:var(--muted); max-width:60ch; line-height:1.7; }
    .cta{ display:flex; gap:16px; margin-top:32px; flex-wrap:wrap; }
    .btn{ appearance:none; border:none; cursor:pointer; font-weight:700; padding:16px 24px; border-radius:var(--radius); transition: all .3s ease; text-decoration:none; font-size:16px; }
    .btn-primary{ background:linear-gradient(135deg, var(--brand), var(--brand-2)); color:white; box-shadow:var(--shadow); }
    .btn-primary:hover{ transform: translateY(-3px); box-shadow:0 25px 50px -12px rgba(167, 139, 250, 0.4); filter: brightness(1.05); }
    .btn-ghost{ background:var(--card); color:var(--text); border:2px solid var(--brand); box-shadow:var(--shadow-soft); }
    .btn-ghost:hover{ background:var(--brand); color:white; transform: translateY(-3px); }

    .hero-card{ background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.12); border-radius: var(--radius-xl); padding:16px; box-shadow: var(--shadow); }
    .hero-media{ aspect-ratio: 16/10; border-radius: 16px; overflow:hidden; position:relative; background:#0f1530; }
    .hero-media img{ width:100%; height:100%; object-fit:cover; opacity:.88; }
    .badge{ position:absolute; right:14px; top:14px; background:rgba(11,16,32,.7); border:1px solid rgba(255,255,255,.12); padding:6px 10px; border-radius:999px; font-size:12px; color:var(--muted); }

    /* Feature cards */
    .section{ padding:48px 0; }
    .section h2{ font-size: clamp(24px, 3.8vw, 36px); margin:0 0 18px; position: relative; display: inline-block; }
    .section h2::after { content: ''; position: absolute; bottom: -8px; left: 0; width: 60px; height: 3px; background: linear-gradient(90deg, var(--brand), var(--brand-2)); border-radius: 3px; }
    .features{ display:grid; grid-template-columns: repeat(3, 1fr); gap:24px; }
    .card{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border:1px solid rgba(255,255,255,.15); border-radius: var(--radius); padding:24px; box-shadow: var(--shadow-soft); transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.2); border-color: rgba(255,255,255,0.25); }
    .card h3{ margin:8px 0 8px; font-size: 18px; }
    .card p{ color:var(--muted); margin:0; }
    .chip{ display:inline-flex; align-items:center; gap:8px; font-size:12px; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1); color:var(--muted); }

    /* Stats */
    .stats{ display:grid; grid-template-columns: repeat(4, 1fr); gap:18px; margin-top:24px; }
    .stat{ background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border:1px solid rgba(255,255,255,.12); border-radius:var(--radius); padding:20px; text-align:center; transition:all 0.3s ease; box-shadow:var(--shadow-soft); position:relative; overflow:hidden; }
    .stat:hover{ transform:translateY(-5px); box-shadow:0 12px 24px rgba(0,0,0,.25); border-color:rgba(255,255,255,.2); }
    .stat::before{ content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%); opacity:0; transition:opacity 0.5s ease; pointer-events:none; }
    .stat:hover::before{ opacity:1; }
    .stat-icon{ font-size:36px; margin-bottom:12px; display:inline-block; transform:scale(1); transition:transform 0.3s ease; }
    .stat:hover .stat-icon{ transform:scale(1.2); }
    .stat strong{ display:block; font-size: clamp(18px, 2vw, 22px); margin-bottom:8px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; overflow:hidden; text-overflow:ellipsis; }
    .stat span{ color:var(--muted); font-size:13px; line-height:1.3; display:block; max-width:100%; overflow:hidden; text-overflow:ellipsis; }

    /* How to Use */
    .how-to-use-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:24px; margin-bottom:40px; }
    .step-card{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border:1px solid rgba(255,255,255,.15); border-radius: var(--radius); padding:28px; text-align:center; box-shadow: var(--shadow-soft); transition: all 0.3s ease; position:relative; overflow:hidden; }
    .step-card:hover{ transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.2); border-color: rgba(255,255,255,0.25); }
    .step-card::before{ content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%); opacity:0; transition:opacity 0.5s ease; pointer-events:none; }
    .step-card:hover::before{ opacity:1; }
    .step-number{ position:absolute; top:16px; right:16px; width:32px; height:32px; border-radius:50%; background:linear-gradient(135deg, var(--brand), var(--brand-2)); color:white; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:14px; }
    .step-icon{ font-size:48px; margin-bottom:16px; display:inline-block; transform:scale(1); transition:transform 0.3s ease; }
    .step-card:hover .step-icon{ transform:scale(1.1); }
    .step-card h3{ margin:0 0 12px; font-size:18px; color:var(--text); }
    .step-card p{ color:var(--muted); margin:0; line-height:1.6; }
    
    .scoring-info{ margin-top:32px; }
    .scoring-card{ background: linear-gradient(135deg, rgba(167, 139, 250, 0.1), rgba(103, 232, 249, 0.1)); border:2px solid rgba(167, 139, 250, 0.3); border-radius: var(--radius-xl); padding:32px; text-align:center; box-shadow: var(--shadow); }
    .scoring-icon{ font-size:56px; margin-bottom:16px; display:inline-block; }
    .scoring-card h3{ margin:0 0 20px; font-size:24px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .scoring-item{ display:flex; align-items:center; justify-content:center; gap:16px; margin-bottom:16px; font-size:20px; font-weight:700; }
    .bottles{ color:var(--accent); }
    .equals{ color:var(--muted); font-size:24px; }
    .hours{ color:var(--accent-2); }
    .scoring-details p{ color:var(--muted); margin:0; line-height:1.6; max-width:500px; margin:0 auto; }

    /* Testimonial */
    .quote{ display:grid; grid-template-columns: .9fr 1.1fr; gap:22px; align-items:center; }
    .quote-card{ background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.12); border-radius: var(--radius-xl); padding:22px; box-shadow: var(--shadow); }
    blockquote{ margin:0; font-size: clamp(16px, 1.4vw, 18px); }
    .author{ display:flex; align-items:center; gap:12px; margin-top:14px; color:var(--muted); }
    .avatar{ width:38px; height:38px; border-radius:50%; background:linear-gradient(135deg, var(--brand), var(--brand-2)); }

    /* CTA strip */
    .cta-strip{ margin:40px 0; padding:30px; border-radius:var(--radius-xl); background: linear-gradient(120deg, rgba(124,92,255,.25), rgba(34,211,238,.22)); border:1px solid rgba(255,255,255,.18); display:flex; align-items:center; justify-content:space-between; gap:20px; flex-wrap:wrap; box-shadow: var(--shadow); position: relative; overflow: hidden; }
    .cta-strip::before { content: ''; position: absolute; top: -100%; left: -100%; width: 300%; height: 300%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%); opacity: 0; transition: opacity 0.5s ease; pointer-events: none; }
    .cta-strip:hover::before { opacity: 1; }
    .cta-strip strong { font-size: 22px; }
    .btn { transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }

    /* Leaderboard */
    .leaderboard-container{ background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.12); border-radius: var(--radius-xl); padding:32px; box-shadow: var(--shadow); }
    .leaderboard-loading{ text-align:center; padding:40px; }
    .loading-spinner{ width:40px; height:40px; border:4px solid rgba(167, 139, 250, 0.2); border-top:4px solid var(--brand); border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 16px; }
    @keyframes spin{ 0%{ transform:rotate(0deg); } 100%{ transform:rotate(360deg); } }
    .leaderboard-podium{ display:grid; grid-template-columns: repeat(3, 1fr); gap:20px; margin-bottom:32px; }
    .podium-item{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border:2px solid; border-radius: var(--radius); padding:24px; text-align:center; position:relative; transition: all 0.3s ease; animation: bounceIn 0.8s ease-out; opacity: 0; animation-fill-mode: forwards; }
     .podium-item:hover{ transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.2); animation: pulseGlow 2s infinite; }
     .podium-item.first{ border-color: #ffd700; background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05)); animation-delay: 0.2s; }
     .podium-item.second{ border-color: #c0c0c0; background: linear-gradient(135deg, rgba(192, 192, 192, 0.1), rgba(192, 192, 192, 0.05)); animation-delay: 0s; }
     .podium-item.third{ border-color: #cd7f32; background: linear-gradient(135deg, rgba(205, 127, 50, 0.1), rgba(205, 127, 50, 0.05)); animation-delay: 0.4s; }
    .podium-rank{ position:absolute; top:-12px; left:50%; transform:translateX(-50%); width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:14px; }
    .podium-rank.first{ background: linear-gradient(135deg, #ffd700, #ffed4e); color:#000; }
    .podium-rank.second{ background: linear-gradient(135deg, #c0c0c0, #e5e5e5); color:#000; }
    .podium-rank.third{ background: linear-gradient(135deg, #cd7f32, #daa520); color:#fff; }
    .podium-avatar{ width:60px; height:60px; border-radius:50%; background: linear-gradient(135deg, var(--brand), var(--brand-2)); margin:0 auto 12px; display:flex; align-items:center; justify-content:center; font-size:24px; color:white; font-weight:800; }
    .podium-name{ font-weight:700; margin-bottom:8px; color:var(--text); }
    .podium-bottles{ font-size:20px; font-weight:800; margin-bottom:4px; }
    .podium-bottles.first{ background: linear-gradient(135deg, #ffd700, #ffed4e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .podium-bottles.second{ background: linear-gradient(135deg, #c0c0c0, #e5e5e5); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .podium-bottles.third{ background: linear-gradient(135deg, #cd7f32, #daa520); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .podium-hours{ color:var(--muted); font-size:14px; }
    .leaderboard-item{ display:flex; align-items:center; gap:16px; padding:16px; background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); border-radius: var(--radius); margin-bottom:12px; transition: all 0.3s ease, transform 0.5s ease, background 0.3s ease; animation: fadeInUp 0.6s ease-out; }
    .leaderboard-item.updating{ transform: scale(1.02); background: linear-gradient(180deg, rgba(74, 144, 226, 0.1), rgba(74, 144, 226, 0.05)); border-color: rgba(74, 144, 226, 0.3); box-shadow: 0 6px 20px rgba(74, 144, 226, 0.2); }
    .leaderboard-item.rank-up{ animation: rankUp 0.8s ease; }
    .leaderboard-item.rank-down{ animation: rankDown 0.8s ease; }
    .leaderboard-item:hover{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border-color: rgba(255,255,255,.15); transform: translateX(8px); }
    .leaderboard-rank{ width:32px; height:32px; border-radius:50%; background: linear-gradient(135deg, var(--brand), var(--brand-2)); color:white; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:14px; flex-shrink:0; }
    .leaderboard-avatar{ width:48px; height:48px; border-radius:50%; background: linear-gradient(135deg, var(--brand), var(--brand-2)); display:flex; align-items:center; justify-content:center; font-size:18px; color:white; font-weight:700; flex-shrink:0; }
    .leaderboard-info{ flex:1; }
    .leaderboard-name{ font-weight:600; margin-bottom:4px; color:var(--text); }
    .leaderboard-details{ color:var(--muted); font-size:14px; }
    .leaderboard-bottles{ font-size:18px; font-weight:800; color:var(--brand); margin-right:8px; }
    .leaderboard-hours{ color:var(--muted); font-size:14px; }
    .leaderboard-error{ text-align:center; padding:40px; color:var(--muted); }
    
    /* Leaderboard Tabs */
    .leaderboard-tabs{ display:flex; gap:8px; margin:24px 0; justify-content:center; }
    .tab-btn{ padding:12px 24px; border:2px solid rgba(255,255,255,.12); background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); color:var(--muted); border-radius: var(--radius); cursor:pointer; transition: all 0.3s ease; font-weight:600; }
    .tab-btn:hover{ border-color: rgba(167, 139, 250, 0.5); color:var(--text); transform: translateY(-2px); }
    .tab-btn.active{ border-color: var(--brand); background: linear-gradient(135deg, var(--brand), var(--brand-2)); color:white; box-shadow: 0 4px 15px rgba(167, 139, 250, 0.3); }
    .podium-team{ color:var(--muted); font-size:12px; margin-bottom:8px; font-weight:500; }

    /* Animation Keyframes */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3);
      }
      50% {
        opacity: 1;
        transform: scale(1.05);
      }
      70% {
        transform: scale(0.9);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes pulseGlow {
       0% {
         transform: scale(1);
         box-shadow: var(--shadow-soft);
       }
       50% {
         transform: scale(1.02);
         box-shadow: 0 15px 30px rgba(167, 139, 250, 0.3);
       }
       100% {
         transform: scale(1);
         box-shadow: var(--shadow-soft);
       }
     }
     
     @keyframes rankUp {
       0% {
         transform: translateY(0);
       }
       25% {
         transform: translateY(-10px) scale(1.05);
         background: linear-gradient(180deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
         border-color: rgba(34, 197, 94, 0.4);
       }
       50% {
         transform: translateY(-5px) scale(1.02);
       }
       100% {
         transform: translateY(0) scale(1);
       }
     }
     
     @keyframes rankDown {
       0% {
         transform: translateY(0);
       }
       25% {
         transform: translateY(10px) scale(0.98);
         background: linear-gradient(180deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
         border-color: rgba(239, 68, 68, 0.4);
       }
       50% {
         transform: translateY(5px) scale(0.99);
       }
       100% {
         transform: translateY(0) scale(1);
       }
     }

     /* Enhanced Theme Toggle Button */
     #theme-toggle {
       position: relative;
       background: linear-gradient(135deg, var(--brand), var(--brand-2));
       border: none;
       color: white;
       padding: 12px 20px;
       border-radius: 25px;
       cursor: pointer;
       font-size: 16px;
       font-weight: 600;
       transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
       box-shadow: 0 4px 15px rgba(167, 139, 250, 0.3);
       overflow: hidden;
       min-width: 60px;
       display: flex;
       align-items: center;
       justify-content: center;
     }

     #theme-toggle::before {
       content: '';
       position: absolute;
       top: 0;
       left: -100%;
       width: 100%;
       height: 100%;
       background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
       transition: left 0.5s;
     }

     #theme-toggle:hover {
       transform: translateY(-2px) scale(1.05);
       box-shadow: 0 8px 25px rgba(167, 139, 250, 0.4);
     }

     #theme-toggle:hover::before {
       left: 100%;
     }

     #theme-toggle:active {
       transform: translateY(0) scale(0.98);
       transition: all 0.1s;
     }

     /* Theme toggle animation */
     @keyframes themeSwitch {
       0% { transform: rotate(0deg) scale(1); }
       50% { transform: rotate(180deg) scale(1.1); }
       100% { transform: rotate(360deg) scale(1); }
     }

     #theme-toggle.switching {
        animation: themeSwitch 0.6s ease-in-out;
      }

      /* Loading Skeleton Styles */
      .skeleton {
        background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
        border-radius: var(--radius);
      }

      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      .skeleton-podium {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 32px;
      }

      .skeleton-podium-item {
        height: 200px;
        border-radius: var(--radius);
        position: relative;
        overflow: hidden;
      }

      .skeleton-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .skeleton-list-item {
        height: 80px;
        border-radius: var(--radius);
        position: relative;
        overflow: hidden;
      }

      .skeleton-text {
        height: 20px;
        margin: 8px 0;
        border-radius: 4px;
      }

      .skeleton-text.short {
        width: 60%;
      }

      .skeleton-text.medium {
        width: 80%;
      }

      .skeleton-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        margin: 16px auto;
      }

      /* Hide skeleton when content loads */
      .leaderboard-content:not([style*="display: none"]) ~ .skeleton-container {
        display: none;
      }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .modal {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: var(--card);
      border-radius: var(--radius-xl);
      padding: 32px;
      width: min(500px, 90vw);
      box-shadow: var(--shadow);
      border: 1px solid rgba(167, 139, 250, 0.2);
      transition: all 0.3s ease;
    }
    
    .modal-overlay.active .modal {
      transform: translate(-50%, -50%) scale(1);
    }
    
    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }
    
    .modal-title {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0;
    }
    
    .close-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: rgba(167, 139, 250, 0.1);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--muted);
      transition: all 0.3s ease;
    }
    
    .close-btn:hover {
      background: rgba(167, 139, 250, 0.2);
      transform: scale(1.1);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text);
    }
    
    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid rgba(167, 139, 250, 0.2);
      border-radius: var(--radius);
      background: var(--bg);
      color: var(--text);
      transition: all 0.3s ease;
      font-family: inherit;
    }
    
    .form-input:focus {
      outline: none;
      border-color: var(--brand);
      background: var(--card);
      transform: translateY(-2px);
      box-shadow: var(--shadow-soft);
    }
    
    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .btn-submit {
      width: 100%;
      margin-top: 8px;
    }

    /* Footer */
    footer{ padding:28px 0 44px; color:var(--muted); border-top: 1px solid rgba(255,255,255,.08); margin-top:28px; }
    .foot{ display:grid; grid-template-columns: 1fr auto; align-items:center; }

    /* Responsive */
    @media (max-width: 900px){
      .hero-grid{ grid-template-columns: 1fr; }
      .quote{ grid-template-columns: 1fr; }
      .features{ grid-template-columns: 1fr 1fr; }
      .how-to-use-grid{ grid-template-columns: 1fr 1fr; gap:20px; }
      .stats{ grid-template-columns: 1fr 1fr; gap:16px; }
      .stat{ padding:16px; }
      .stat-icon{ font-size:30px; margin-bottom:8px; }
      .stat strong{ font-size: clamp(16px, 3vw, 20px); }
      .stat span{ font-size:12px; }
      .step-card{ padding:24px; }
      .step-icon{ font-size:40px; }
      .scoring-card{ padding:28px; }
      .scoring-icon{ font-size:48px; }
    }
    @media (max-width: 900px){
      .leaderboard-podium{ grid-template-columns: 1fr; gap:16px; }
      .podium-item{ padding:20px; }
      .podium-avatar{ width:50px; height:50px; font-size:20px; }
      .leaderboard-container{ padding:24px; }
    }
    @media (max-width: 560px){
      .features{ grid-template-columns: 1fr; }
      .how-to-use-grid{ grid-template-columns: 1fr; gap:16px; }
      .stats{ grid-template-columns: 1fr; }
      .stat{ margin-bottom:4px; padding:14px; }
      .stat-icon{ font-size:26px; margin-bottom:6px; }
      .stat strong{ font-size: clamp(15px, 4vw, 18px); }
      .stat span{ font-size:11px; line-height:1.2; }
      .step-card{ padding:20px; }
      .step-icon{ font-size:36px; margin-bottom:12px; }
      .step-card h3{ font-size:16px; }
      .step-card p{ font-size:14px; }
      .scoring-card{ padding:24px; }
      .scoring-icon{ font-size:40px; }
      .scoring-card h3{ font-size:20px; }
      .scoring-item{ font-size:18px; gap:12px; flex-wrap:wrap; }
      .modal { padding: 24px; }
      .leaderboard-container{ padding:20px; }
      .podium-item{ padding:16px; }
      .podium-avatar{ width:40px; height:40px; font-size:16px; }
      .podium-bottles{ font-size:18px; }
      .leaderboard-item{ padding:12px; gap:12px; }
      .leaderboard-avatar{ width:40px; height:40px; font-size:16px; }
      .leaderboard-bottles{ font-size:16px; }
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="nav">
    <div class="container nav-inner">
      <a class="brand" href="#" data-aos="fade-right" data-aos-duration="800">
        <img src="nnn.jpg" alt="P2P Logo" class="logo-img" style="border-radius: 10px; box-shadow: 0 6px 12px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
        <span>P2P</span>
      </a>
      <div class="nav-links" data-aos="fade-left" data-aos-duration="800" data-aos-delay="200">
        <a href="#features">คุณสมบัติ</a>
        <a href="#how-it-works">วิธีใช้งาน</a>
        <a href="#rewards">รางวัล</a>
        <button class="btn btn-ghost" id="theme-toggle" title="เปลี่ยนธีม">🌙</button>
        <script>
          // Theme toggle with animation
          const themeToggle = document.getElementById('theme-toggle');
          function setTheme(dark) {
            // Add switching animation
            themeToggle.classList.add('switching');
            
            setTimeout(() => {
              if (dark) {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = '☀️';
                themeToggle.title = 'เปลี่ยนเป็นโหมดสว่าง';
              } else {
                document.documentElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = '🌙';
                themeToggle.title = 'เปลี่ยนเป็นโหมดมืด';
              }
            }, 300);
            
            // Remove animation class after animation completes
            setTimeout(() => {
              themeToggle.classList.remove('switching');
            }, 600);
          }
          // Initial theme
          const userTheme = localStorage.getItem('theme');
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          setTheme(userTheme === 'dark' || (!userTheme && prefersDark));
          // Toggle event
          themeToggle.addEventListener('click', () => {
            setTheme(!document.documentElement.hasAttribute('data-theme'));
          });
        </script>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero">
    <div class="container hero-grid">
      <div>
        <span class="eyebrow" data-aos="fade-up" data-aos-duration="800">
          <span class="pulse-dot"></span> ระบบ AI ตรวจจับขวด 
        </span>
        <h1 data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">หย่อนขวด รับแต้ม</h1>
        <p class="lead" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="400">
          โครงงาน P2P (Plastic to Point) – ระบบแยกขวดอัจฉริยะ เชื่อมต่อ AI และ Arduino เพื่อแปลงขวดพลาสติกเป็นแต้มสะสม เก็บข้อมูลผ่าน Firebase และส่งเสริมการรีไซเคิลอย่างยั่งยืน
        </p>
        <div class="cta" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="600">
          <a class="btn btn-primary" href="login.html">log_in</a>
          <a class="btn btn-ghost" href="register.html">sign_in</a>
        </div>
        <div class="stats" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="800">
          <div class="stat" data-aos="zoom-in" data-aos-duration="600" data-aos-delay="900">
            <div class="stat-icon">🌎</div>
            <strong>ขวดที่แยกวันนี้</strong>
            <span>คือ โลกที่สดใสในวันหน้า</span>
          </div>
          <div class="stat" data-aos="zoom-in" data-aos-duration="600" data-aos-delay="1000">
            <div class="stat-icon">♻️</div>
            <strong>รักษ์โลกง่ายๆ</strong>
            <span>เริ่มต้นที่การแยกขวด</span>
          </div>
          <div class="stat" data-aos="zoom-in" data-aos-duration="600" data-aos-delay="1100">
            <div class="stat-icon">🌱</div>
            <strong>ร่วมเป็นส่วนหนึ่ง</strong>
            <span>ในการดูแลสิ่งแวดล้อม</span>
          </div>
          <div class="stat" data-aos="zoom-in" data-aos-duration="600" data-aos-delay="1200">
            <div class="stat-icon">💧</div>
            <strong>ทุกขวดมีค่า</strong>
            <span>เมื่อเรารู้จักจัดการ</span>
          </div>
        </div>
      </div>
      <div class="hero-card" data-aos="fade-left" data-aos-duration="1000" data-aos-delay="400">
        <div class="hero-media">
          <img src="ขวดโรงเรียน.jpg" alt="ขวดโรงเรียน" style="border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.15); transition: all 0.5s ease;"/>
          <span class="badge">ขวดโรงเรียน</span>
        </div>
      </div>
    </div>
  </header>

  <!-- FEATURES -->
  <section id="features" class="section">
    <div class="container">
      <h2 data-aos="fade-up" data-aos-duration="800">จุดเด่นหลัก</h2>
      <div class="features">
        <article class="card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
          <span class="chip">🏕 Re for green world 🏕</span>
          <h3>ส่งเสริมพฤติกรรมการรีไซเคิล</h3> 
          <p>เพื่อโลกที่สะอาดขึ้น.</p>
        </article>
        <article class="card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="200">
          <span class="chip">🏫 Re for school 🏫</span>
          <h3>ลดปัญหาขยะขวดน้ำในพื้นที่โรงเรียน</h3>
          <p>แค่แยกขวดน้ำโรงเรียนก็น่าอยู่ขึ้น</p>
        </article>
        <article class="card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300">
          <span class="chip">☘️ easy to Re ☘️</span>
          <h3>ใช้งานง่าย ผ่านแอปพลิเคชัน</h3>
          <p>แค่สแกน QR Code ก็สามารถเช็คจำนวนขวดได้เลย</p>
        </article>
      </div>
    </div>
  </section>

  <!-- HOW TO USE -->
  <section id="how-to-use" class="section">
    <div class="container">
      <h2 data-aos="fade-up" data-aos-duration="800">วิธีการใช้งานเครื่อง</h2>
      <div class="how-to-use-grid">
        <div class="step-card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="100">
          <div class="step-number">1</div>
          <div class="step-icon">🔐</div>
          <h3>เข้าสู่ระบบที่ตัวเครื่อง</h3>
          <p>ล็อกอินเข้าสู่ระบบผ่านหน้าจอของเครื่องเพื่อเริ่มใช้งาน</p>
        </div>
        <div class="step-card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="200">
          <div class="step-number">2</div>
          <div class="step-icon">🍼</div>
          <h3>ใส่ขวดไปในช่องสำหรับใส่</h3>
          <p>นำขวดพลาสติกที่ต้องการรีไซเคิลใส่ลงในช่องที่กำหนดไว้</p>
        </div>
        <div class="step-card" data-aos="fade-up" data-aos-duration="800" data-aos-delay="300">
          <div class="step-number">3</div>
          <div class="step-icon">📱</div>
          <h3>ระบบนับขวดและแสดงผล</h3>
          <p>ระบบ AI จะทำการตรวจจับและนับขวด แล้วแสดงผลในแอปพลิเคชัน</p>
        </div>
      </div>
      
      <div class="scoring-info" data-aos="fade-up" data-aos-duration="800" data-aos-delay="400">
        <div class="scoring-card">
          <div class="scoring-icon">⏰</div>
          <h3>หลักเกณฑ์การให้คะแนน</h3>
          <div class="scoring-details">
            <div class="scoring-item">
              <span class="bottles">30 ขวด</span>
              <span class="equals">=</span>
              <span class="hours">1 ชั่วโมงจิตอาสา</span>
            </div>
            <p>แอปพลิเคชันจะแสดงจำนวนขวดที่สะสมและค่าเฉลี่ยขวดที่แปลงเป็นชั่วโมงจิตอาสา</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TESTIMONIAL / QUOTE -->
  <section class="section">
    <div class="container quote">
      <div class="quote-card" data-aos="fade-right" data-aos-duration="1000">
        <blockquote>"ขวดไม่ขยะ ถ้าเราแยกอย่างฉลาด."</blockquote>
        <div class="author">
          <div class="avatar" aria-hidden="true"></div>
          <span>ทีม อ้ายมา 6 คน • นักพัฒนา Frontend</span>
        </div>
      </div>
      <img class="quote-visual" alt="ภาพประกอบ" 
           src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1200&auto=format&fit=crop" 
           style="width:100%; border-radius:16px; box-shadow: var(--shadow-soft); opacity:.95"
           data-aos="fade-left" data-aos-duration="1000" data-aos-delay="200"/>
    </div>
  </section>

  <!-- LEADERBOARD -->
  <section id="leaderboard" class="section">
    <div class="container">
      <h2 data-aos="fade-up" data-aos-duration="800">🏆 อันดับผู้เก็บขวดยอดเยี่ยม</h2>
      <div class="leaderboard-container" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">
        <div class="leaderboard-loading" id="leaderboard-loading">
          <div class="skeleton-container">
            <div class="skeleton-podium">
              <div class="skeleton skeleton-podium-item">
                <div class="skeleton skeleton-avatar"></div>
                <div class="skeleton skeleton-text short" style="margin: 16px auto 8px;"></div>
                <div class="skeleton skeleton-text medium" style="margin: 8px auto;"></div>
              </div>
              <div class="skeleton skeleton-podium-item">
                <div class="skeleton skeleton-avatar"></div>
                <div class="skeleton skeleton-text short" style="margin: 16px auto 8px;"></div>
                <div class="skeleton skeleton-text medium" style="margin: 8px auto;"></div>
              </div>
              <div class="skeleton skeleton-podium-item">
                <div class="skeleton skeleton-avatar"></div>
                <div class="skeleton skeleton-text short" style="margin: 16px auto 8px;"></div>
                <div class="skeleton skeleton-text medium" style="margin: 8px auto;"></div>
              </div>
            </div>
            <div class="skeleton-list">
              <div class="skeleton skeleton-list-item"></div>
              <div class="skeleton skeleton-list-item"></div>
              <div class="skeleton skeleton-list-item"></div>
              <div class="skeleton skeleton-list-item"></div>
              <div class="skeleton skeleton-list-item"></div>
            </div>
          </div>
        </div>
        <div class="leaderboard-content" id="leaderboard-content" style="display: none;">
          <div class="leaderboard-podium">
            <!-- Top 3 will be inserted here -->
          </div>
          <div class="leaderboard-list">
            <!-- Other rankings will be inserted here -->
          </div>
        </div>
        <div class="leaderboard-error" id="leaderboard-error" style="display: none;">
          <p>⚠️ ไม่สามารถโหลดข้อมูลได้ กรุณาลองใหม่อีกครั้ง</p>
          <button class="btn btn-ghost" onclick="loadLeaderboard()">โหลดใหม่</button>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA STRIP -->
  <section class="container cta-strip" id="start" data-aos="zoom-in" data-aos-duration="800">
    <strong>พร้อมเริ่มหรือยัง?</strong>
    <div class="cta">
      <a class="btn btn-primary" href="login.html">login</a><br>
      <button class="btn btn-ghost" id="contact-btn">พูดคุยกับเรา</button>
      <a class="btn btn-ghost" href="form.html">บันทึกความพึงพอใจ</a>
    </div>
  </section>

  <!-- Contact Modal -->
  <div class="modal-overlay" id="contact-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ติดต่อเรา</h3>
        <button class="close-btn" id="close-modal">×</button>
      </div>
      <form id="contact-form" action="https://formspree.io/f/mwpqdzdk" method="POST">
        <div class="form-group">
          <label class="form-label" for="name">ชื่อ</label>
          <input type="text" name="name" id="name" class="form-input" placeholder="กรอกชื่อของคุณ" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="email">อีเมล</label>
          <input type="email" name="email" id="email" class="form-input" placeholder="example@email.com" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="phone">เบอร์โทร</label>
          <input type="tel" name="phone" id="phone" class="form-input" placeholder="08X-XXX-XXXX">
        </div>
        <div class="form-group">
          <label class="form-label" for="message">ข้อความ</label>
          <textarea name="message" id="message" class="form-input form-textarea" placeholder="เขียนข้อความที่คุณต้องการสื่อสาร..." required></textarea>
        </div>
        <!-- Honeypot field สำหรับป้องกัน spam -->
        <input type="text" name="_gotcha" style="display:none !important">
        
        <button type="submit" class="btn btn-primary btn-submit" id="submit-btn">
          <span class="btn-text">ส่งข้อความ</span>
          <span class="btn-loading" style="display:none;">กำลังส่ง...</span>
        </button>
      </form>
    </div>
  </div>

  <!-- FOOTER -->
  <footer data-aos="fade-up" data-aos-duration="600">
    <div class="container foot">
      <p>© 2025 P2P (Plastic to Point). สงวนลิขสิทธิ์</p>
      
    </div>
  </footer>

  <!-- AOS JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  
  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
    import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAmw1lDRZIxYKDblO8nhS3SR5aTVCVPJbg",
      authDomain: "takultoujink.firebaseapp.com",
      projectId: "takultoujink",
      storageBucket: "takultoujink.firebasestorage.app",
      messagingSenderId: "865462073491",
      appId: "1:865462073491:web:5985dfd8a0e91b71fa3566",
      measurementId: "G-ZVXD02VSWF",
      databaseURL: "https://takultoujink-default-rtdb.asia-southeast1.firebasedatabase.app"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const db = getFirestore(app);

    // Team color mapping
    const teamColors = {
      'red': { name: 'ทีมแดง', color: '#ef4444' },
      'yellow': { name: 'ทีมเหลือง', color: '#f59e0b' },
      'purple': { name: 'ทีมม่วง', color: '#8b5cf6' },
      'blue': { name: 'ทีมฟ้า', color: '#3b82f6' },
      'green': { name: 'ทีมเขียว', color: '#10b981' }
    };

    // Leaderboard functions
    window.loadLeaderboard = async function() {
      const loadingEl = document.getElementById('leaderboard-loading');
      const contentEl = document.getElementById('leaderboard-content');
      const errorEl = document.getElementById('leaderboard-error');
      
      // Show loading state
      loadingEl.style.display = 'block';
      contentEl.style.display = 'none';
      errorEl.style.display = 'none';
      
      try {
        // Get all users' data from Firestore and bottles data from Realtime Database
        const [usersSnapshot, bottlesSnapshot] = await Promise.all([
          getDocs(collection(db, 'users')),
          new Promise((resolve, reject) => {
            const bottlesRef = ref(database, 'bottles');
            onValue(bottlesRef, resolve, reject, { onlyOnce: true });
          })
        ]);
        
        const usersData = {};
        usersSnapshot.forEach(doc => {
          usersData[doc.id] = doc.data();
        });
        
        const bottlesData = bottlesSnapshot.val();
        
        if (bottlesData) {
          const leaderboardData = [];
          const teamStats = {
            'red': { name: 'ทีมแดง', bottles: 0, members: 0 },
            'yellow': { name: 'ทีมเหลือง', bottles: 0, members: 0 },
            'purple': { name: 'ทีมม่วง', bottles: 0, members: 0 },
            'blue': { name: 'ทีมฟ้า', bottles: 0, members: 0 },
            'green': { name: 'ทีมเขียว', bottles: 0, members: 0 }
          };
          
          // Process user data
          Object.keys(bottlesData).forEach(userId => {
            const bottleData = bottlesData[userId];
            const userData = usersData[userId];
            
            if (bottleData && bottleData.total > 0) {
              const teamColor = userData?.teamColor || 'unknown';
              
              leaderboardData.push({
                userId: userId,
                name: userData?.displayName || bottleData.displayName || bottleData.email || 'ผู้ใช้ไม่ระบุชื่อ',
                bottles: bottleData.total || 0,
                hours: Math.floor((bottleData.total || 0) / 30),
                teamColor: teamColor
              });
              
              // Update team stats
              if (teamStats[teamColor]) {
                teamStats[teamColor].bottles += bottleData.total || 0;
                teamStats[teamColor].members += 1;
              }
            }
          });
          
          // Sort by bottles count (descending)
          leaderboardData.sort((a, b) => b.bottles - a.bottles);
          
          // Display leaderboard
          displayLeaderboard(leaderboardData, teamStats);
          
          // Hide loading, show content
          loadingEl.style.display = 'none';
          contentEl.style.display = 'block';
        } else {
          throw new Error('ไม่พบข้อมูล');
        }
      } catch (error) {
        console.error('Error loading leaderboard:', error);
        loadingEl.style.display = 'none';
        errorEl.style.display = 'block';
      }
    };

    function displayLeaderboard(data) {
      // Check if we need to add tabs
      if (!document.querySelector('.leaderboard-tabs')) {
        const leaderboardSection = document.querySelector('.leaderboard');
        const leaderboardTitle = leaderboardSection.querySelector('h2');
        const tabsContainer = document.createElement('div');
        tabsContainer.className = 'leaderboard-tabs';
        tabsContainer.innerHTML = `
          <button class="tab-btn active" onclick="showLeaderboard('individual')">อันดับบุคคล</button>
          <button class="tab-btn" onclick="showLeaderboard('team')">อันดับทีม</button>
        `;
        leaderboardTitle.insertAdjacentElement('afterend', tabsContainer);
      }
      
      // Store data globally for tab switching
      window.leaderboardData = data;
      
      // Display individual leaderboard by default
      displayIndividualLeaderboard(data.users);
    }

    function showLeaderboard(type) {
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');

      if (type === 'individual') {
        displayIndividualLeaderboard(window.leaderboardData.users);
      } else {
        displayTeamLeaderboard(window.leaderboardData.teams);
      }
    }

    function displayIndividualLeaderboard(users) {
      const podiumEl = document.querySelector('.leaderboard-podium');
      const listEl = document.querySelector('.leaderboard-list');
      
      // Clear existing content
      podiumEl.innerHTML = '';
      listEl.innerHTML = '';
      
      // Display top 3 in podium
      const top3 = users.slice(0, 3);
      top3.forEach((user, index) => {
        const rank = index + 1;
        const rankClass = rank === 1 ? 'first' : rank === 2 ? 'second' : 'third';
        const teamColor = teamColors[user.teamColor] || { name: 'ไม่ระบุ', color: '#gray' };
        
        const podiumItem = document.createElement('div');
        podiumItem.className = `podium-item ${rankClass}`;
        podiumItem.innerHTML = `
          <div class="podium-rank ${rankClass}">${rank}</div>
          <div class="podium-avatar" style="border: 3px solid ${teamColor.color};">${user.name.charAt(0).toUpperCase()}</div>
          <div class="podium-name">${user.name}</div>
          <div class="podium-team" style="color: ${teamColor.color};">ทีม${teamColor.name}</div>
          <div class="podium-bottles ${rankClass}">${user.bottles} ขวด</div>
          <div class="podium-hours">${user.hours} ชั่วโมงจิตอาสา</div>
        `;
        podiumEl.appendChild(podiumItem);
      });
      
      // Display remaining users in list
      const remaining = users.slice(3);
      remaining.forEach((user, index) => {
        const rank = index + 4;
        const teamColor = teamColors[user.teamColor] || { name: 'ไม่ระบุ', color: '#gray' };
        
        const listItem = document.createElement('div');
        listItem.className = 'leaderboard-item';
        listItem.innerHTML = `
          <div class="leaderboard-rank">${rank}</div>
          <div class="leaderboard-avatar" style="border: 2px solid ${teamColor.color};">${user.name.charAt(0).toUpperCase()}</div>
          <div class="leaderboard-info">
            <div class="leaderboard-name">${user.name}</div>
            <div class="leaderboard-details">ทีม${teamColor.name} • ${user.hours} ชั่วโมงจิตอาสา</div>
          </div>
          <div>
            <span class="leaderboard-bottles">${user.bottles}</span>
            <span class="leaderboard-hours">ขวด</span>
          </div>
        `;
        listEl.appendChild(listItem);
      });
      
      // If no data to show in list
      if (remaining.length === 0 && top3.length > 0) {
        listEl.innerHTML = '<div style="text-align:center; padding:20px; color:var(--muted);">🎉 ยินดีด้วย! คุณอยู่ใน Top 3</div>';
      } else if (users.length === 0) {
        podiumEl.innerHTML = '<div style="text-align:center; padding:40px; color:var(--muted); grid-column: 1 / -1;">📊 ยังไม่มีข้อมูลการเก็บขวด<br><small>เริ่มเก็บขวดเพื่อขึ้นอันดับกันเถอะ!</small></div>';
      }
    }

    function displayTeamLeaderboard(teams) {
      const podiumEl = document.querySelector('.leaderboard-podium');
      const listEl = document.querySelector('.leaderboard-list');
      
      // Clear existing content
      podiumEl.innerHTML = '';
      listEl.innerHTML = '';
      
      // Display top 3 teams in podium
      const top3 = teams.slice(0, 3);
      top3.forEach((team, index) => {
        const rank = index + 1;
        const rankClass = rank === 1 ? 'first' : rank === 2 ? 'second' : 'third';
        const teamColor = teamColors[team.color] || { name: 'ไม่ระบุ', color: '#gray' };
        
        const podiumItem = document.createElement('div');
        podiumItem.className = `podium-item ${rankClass}`;
        podiumItem.innerHTML = `
          <div class="podium-rank ${rankClass}">${rank}</div>
          <div class="podium-avatar" style="background-color: ${teamColor.color}; color: white;">ทีม</div>
          <div class="podium-name">ทีม${teamColor.name}</div>
          <div class="podium-team">${team.members} สมาชิก</div>
          <div class="podium-bottles ${rankClass}">${team.bottles} ขวด</div>
          <div class="podium-hours">รวม ${team.hours} ชั่วโมงจิตอาสา</div>
        `;
        podiumEl.appendChild(podiumItem);
      });
      
      // Display remaining teams in list
      const remaining = teams.slice(3);
      remaining.forEach((team, index) => {
        const rank = index + 4;
        const teamColor = teamColors[team.color] || { name: 'ไม่ระบุ', color: '#gray' };
        
        const listItem = document.createElement('div');
        listItem.className = 'leaderboard-item';
        listItem.innerHTML = `
          <div class="leaderboard-rank">${rank}</div>
          <div class="leaderboard-avatar" style="background-color: ${teamColor.color}; color: white;">ทีม</div>
          <div class="leaderboard-info">
            <div class="leaderboard-name">ทีม${teamColor.name}</div>
            <div class="leaderboard-details">${team.members} สมาชิก • รวม ${team.hours} ชั่วโมงจิตอาสา</div>
          </div>
          <div>
            <span class="leaderboard-bottles">${team.bottles}</span>
            <span class="leaderboard-hours">ขวด</span>
          </div>
        `;
        listEl.appendChild(listItem);
      });
      
      // If no data to show in list
       if (remaining.length === 0 && top3.length > 0) {
         listEl.innerHTML = '<div style="text-align:center; padding:20px; color:var(--muted);">🎉 ยินดีด้วย! ทีมคุณอยู่ใน Top 3</div>';
       } else if (teams.length === 0) {
         podiumEl.innerHTML = '<div style="text-align:center; padding:40px; color:var(--muted); grid-column: 1 / -1;">📊 ยังไม่มีข้อมูลทีม<br><small>เริ่มสร้างทีมและเก็บขวดกันเถอะ!</small></div>';
       }
     }
      

    // Load leaderboard when page loads
    document.addEventListener('DOMContentLoaded', () => {
      loadLeaderboard();
      
      // Auto refresh every 30 seconds
      setInterval(loadLeaderboard, 30000);
    });
  </script>
  
  <script>
    // Initialize AOS
    AOS.init({
      duration: 800,
      offset: 100,
      delay: 0,
      once: true,
      mirror: false,
      anchorPlacement: 'top-bottom',
      easing: 'ease-out-cubic'
    });

    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Modal functionality
    const contactBtn = document.getElementById('contact-btn');
    const contactModal = document.getElementById('contact-modal');
    const closeModal = document.getElementById('close-modal');
    const contactForm = document.getElementById('contact-form');

    // เปิด modal
    contactBtn.addEventListener('click', () => {
      contactModal.classList.add('active');
      document.body.style.overflow = 'hidden';
    });

    // ปิด modal เมื่อกดปุ่มปิด
    closeModal.addEventListener('click', () => {
      contactModal.classList.remove('active');
      document.body.style.overflow = 'auto';
    });

    // ปิด modal เมื่อกดพื้นหลัง
    contactModal.addEventListener('click', (e) => {
      if (e.target === contactModal) {
        contactModal.classList.remove('active');
        document.body.style.overflow = 'auto';
      }
    });

    // ปิด modal เมื่อกด ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && contactModal.classList.contains('active')) {
        contactModal.classList.remove('active');
        document.body.style.overflow = 'auto';
      }
    });

    // Handle form submission with Formspree
    contactForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submit-btn');
      const btnText = submitBtn.querySelector('.btn-text');
      const btnLoading = submitBtn.querySelector('.btn-loading');
      
      // แสดงสถานะกำลังส่ง
      submitBtn.disabled = true;
      btnText.style.display = 'none';
      btnLoading.style.display = 'inline';
      
      try {
        const formData = new FormData(contactForm);
        
        const response = await fetch(contactForm.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });
        
        if (response.ok) {
          // ส่งสำเร็จ
          alert('ขอบคุณสำหรับการติดต่อ! เราจะติดต่อกลับในเร็วๆ นี้');
          contactForm.reset();
          contactModal.classList.remove('active');
          document.body.style.overflow = 'auto';
        } else {
          // เกิดข้อผิดพลาด
          const data = await response.json();
          if (data.errors) {
            alert('เกิดข้อผิดพลาด: ' + data.errors.map(error => error.message).join(', '));
          } else {
            alert('เกิดข้อผิดพลาดในการส่งข้อความ กรุณาลองใหม่');
          }
        }
      } catch (error) {
        console.error('Error:', error);
        alert('เกิดข้อผิดพลาดในการส่งข้อความ กรุณาลองใหม่');
      } finally {
        // คืนสถานะปุ่ม
        submitBtn.disabled = false;
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
      }
    });
  </script>
</body>
</html>